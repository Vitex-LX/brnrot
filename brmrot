local WindUI = loadstring(game:HttpGet(
    "https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"
))()

local Window = WindUI:CreateWindow({
    Title   = "Vitex Hub",
    Icon    = "aperture",
    Author  = "by Vitex",
    Theme   = "Violet",
    Acrylic = true,
})

Window:Tag({
    Title  = "Beta-kooon",
    Icon   = "history",
    Color  = Color3.fromHex("#5f0188"),
    Radius = 0,
})

local Practical = Window:Tab({
    Title = "کاربردی",
    Icon  = "flame",
})
Practical:Select()

-- ====== لاجیک پرواز ======
local RunService          = game:GetService("RunService")
local ContextActionService = game:GetService("ContextActionService")
local UserInputService    = game:GetService("UserInputService")
local Players             = game:GetService("Players")

local flyEnabled   = false
local flySpeed     = 50
local flyConnection
local goingUp      = false
local goingDown    = false

local function handleUp(_, inputState)
    goingUp = (inputState == Enum.UserInputState.Begin)
end

local function handleDown(_, inputState)
    goingDown = (inputState == Enum.UserInputState.Begin)
end

local function startFly()
    local player           = Players.LocalPlayer
    local character        = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    local humanoid         = character:WaitForChild("Humanoid")

    humanoid.PlatformStand = true

    local bodyVelocity    = Instance.new("BodyVelocity")
    bodyVelocity.Velocity  = Vector3.zero
    bodyVelocity.MaxForce  = Vector3.new(1e5, 1e5, 1e5)
    bodyVelocity.Parent    = humanoidRootPart

    local bodyGyro        = Instance.new("BodyGyro")
    bodyGyro.MaxTorque     = Vector3.new(1e5, 1e5, 1e5)
    bodyGyro.P             = 1e4
    bodyGyro.Parent        = humanoidRootPart

    -- دکمه‌های بالا/پایین (هم کیبورد هم موبایل)
    ContextActionService:BindAction("FlyUp",   handleUp,   true, Enum.KeyCode.Space)
    ContextActionService:BindAction("FlyDown", handleDown, true, Enum.KeyCode.LeftControl)

    -- استایل دکمه‌های موبایل
    local btnUp   = ContextActionService:GetButton("FlyUp")
    local btnDown = ContextActionService:GetButton("FlyDown")
    if btnUp then
        btnUp.Size     = UDim2.new(0, 70, 0, 70)
        btnUp.Position = UDim2.new(1, -170, 1, -160)
        btnUp.Text     = "▲"
    end
    if btnDown then
        btnDown.Size     = UDim2.new(0, 70, 0, 70)
        btnDown.Position = UDim2.new(1, -85, 1, -160)
        btnDown.Text     = "▼"
    end

    flyConnection = RunService.Heartbeat:Connect(function()
        if not flyEnabled then return end

        local camera   = workspace.CurrentCamera
        local moveDir  = Vector3.zero

        -- جهت حرکت از thumbstick (موبایل) و WASD (کیبورد)
        local hDir = humanoid.MoveDirection
        if hDir.Magnitude > 0.1 then
            moveDir = Vector3.new(hDir.X, 0, hDir.Z)
        end

        -- بالا / پایین
        if goingUp   then moveDir += Vector3.new(0, 1, 0) end
        if goingDown  then moveDir -= Vector3.new(0, 1, 0) end

        -- کیبورد WASD (اگه کیبورد داشت)
        if UserInputService.KeyboardEnabled then
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir += camera.CFrame.LookVector  end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir -= camera.CFrame.LookVector  end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir -= camera.CFrame.RightVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir += camera.CFrame.RightVector end
        end

        bodyVelocity.Velocity = if moveDir.Magnitude > 0
            then moveDir.Unit * flySpeed
            else Vector3.zero

        bodyGyro.CFrame = camera.CFrame
    end)
end

local function stopFly()
    goingUp   = false
    goingDown = false

    ContextActionService:UnbindAction("FlyUp")
    ContextActionService:UnbindAction("FlyDown")

    local character = Players.LocalPlayer.Character
    if not character then return end

    local hrp      = character:FindFirstChild("HumanoidRootPart")
    local humanoid = character:FindFirstChild("Humanoid")

    if humanoid then humanoid.PlatformStand = false end
    if hrp then
        local bv = hrp:FindFirstChildOfClass("BodyVelocity")
        local bg = hrp:FindFirstChildOfClass("BodyGyro")
        if bv then bv:Destroy() end
        if bg then bg:Destroy() end
    end
    if flyConnection then
        flyConnection:Disconnect()
        flyConnection = nil
    end
end

-- ====== Toggle پرواز ======
local FlyToggle = Practical:Toggle({
    Title    = "پرواز",
    Desc     = "موبایل: thumbstick + دکمه‌های ▲▼",
    Icon     = "plane",
    Value    = false,
    Callback = function(state)
        flyEnabled = state
        if state then
            startFly()
        else
            stopFly()
        end
    end,
})
