local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local SelectedPlayerName = nil

-- لود کردن WindUI
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

local Window = WindUI:CreateWindow({
    Title  = "Vitex Hub",
    Icon   = "aperture",
    Author = "by Vitex",
    Theme  = "Violet",
    Acrylic = true,
})

local FlingTab = Window:Tab({
    Title = "فلینگ",
    Icon = "user-minus",
})

-- تابع کمکی برای لیست پلیرها
local function getPlayersList()
    local tbl = {}
    for _, v in pairs(Players:GetPlayers()) do
        if v ~= LocalPlayer then table.insert(tbl, v.Name) end
    end
    return tbl
end

-- دراپ‌داون انتخاب پلیر
local PlayerList = FlingTab:Dropdown({
    Title = "انتخاب هدف",
    Options = getPlayersList(),
    Callback = function(selected)
        SelectedPlayerName = selected
    end
})

-- دکمه رفرش طبق استاندارد درخواستی تو
local RefreshButton = FlingTab:Button({
    Title = "بروزرسانی لیست پلیرها",
    Callback = function()
        PlayerList:Refresh(getPlayersList())
    end
})

-- دکمه اصلی فلینگ با رعایت تعریف local و فیزیک آنتی-سلف
local FlingButton = FlingTab:Button({
    Title = "شروع عملیات فلینگ",
    Callback = function()
        local targetPlayer = Players:FindFirstChild(SelectedPlayerName)
        local char = LocalPlayer.Character
        local hrp = char and char:FindFirstChild("HumanoidRootPart")
        local hum = char and char:FindFirstChildOfClass("Humanoid")
        
        if targetPlayer and targetPlayer.Character and hrp and hum then
            local targetHrp = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
            
            if targetHrp then
                -- جلوگیری از نشستن یا باگ شدن خودت
                hum.PlatformStand = true
                
                -- ایجاد نیروی چرخشی شدید (فقط در محور عمودی برای حفظ تعادل)
                local bfv = Instance.new("BodyAngularVelocity")
                bfv.Name = "VitexFlingPower"
                bfv.MaxTorque = Vector3.new(0, math.huge, 0) 
                bfv.P = 10^10
                bfv.AngularVelocity = Vector3.new(0, 999999, 0)
                bfv.Parent = hrp

                -- غیرفعال کردن برخورد بدنت با هدف (برای اینکه خودت پرت نشی)
                for _, part in pairs(char:GetChildren()) do
                    if part:IsA("BasePart") then part.CanCollide = false end
                end

                -- انتقال به سمت پلیر
                local tweenInfo = TweenInfo.new(0.7, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
                local tween = TweenService:Create(hrp, tweenInfo, {CFrame = targetHrp.CFrame})
                tween:Play()

                -- صبر برای اثرگذاری ضربه و بعد ریست کردن
                task.wait(1)
                
                bfv:Destroy()
                hum.PlatformStand = false
                for _, part in pairs(char:GetChildren()) do
                    if part:IsA("BasePart") then part.CanCollide = true end
                end
            end
        end
    end
})
