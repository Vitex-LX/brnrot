local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")

local LocalPlayer = Players.LocalPlayer
local FlySettings = { flying = false, speed = 50, up = false, down = false }
local FlyConnection

-- لود کردن WindUI
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

local Window = WindUI:CreateWindow({
    Title  = "Vitexسسصیص Hub",
    Icon   = "aperture",
    Author = "by Vitex",
    Theme  = "Violet",
    Acrylic = true,
})

local Practical = Window:Tab({
    Title = "کاربردی",
    Icon = "flame",
})

-- منطق پرواز مخصوص موبایل و سیستم
local function handleFly()
    local char = LocalPlayer.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") or not char:FindFirstChild("Humanoid") then return end
    
    local hrp = char.HumanoidRootPart
    local humanoid = char.Humanoid

    if FlySettings.flying then
        if not hrp:FindFirstChild("FlyVelocity") then
            local bv = Instance.new("BodyVelocity")
            bv.Name = "FlyVelocity"
            bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
            bv.Parent = hrp

            local bg = Instance.new("BodyGyro")
            bg.Name = "FlyGyro"
            bg.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
            bg.P = 9000
            bg.Parent = hrp

            humanoid.PlatformStand = true
        end

        -- جهت حرکت بر اساس جوی‌استیک موبایل یا کیبورد
        local moveDir = humanoid.MoveDirection * FlySettings.speed
        local verticalMove = Vector3.new(0, 0, 0)
        
        if FlySettings.up then verticalMove = Vector3.new(0, FlySettings.speed, 0) end
        if FlySettings.down then verticalMove = Vector3.new(0, -FlySettings.speed, 0) end

        hrp.FlyVelocity.Velocity = moveDir + verticalMove
        hrp.FlyGyro.CFrame = workspace.CurrentCamera.CFrame
    else
        if hrp:FindFirstChild("FlyVelocity") then hrp.FlyVelocity:Destroy() end
        if hrp:FindFirstChild("FlyGyro") then hrp.FlyGyro:Destroy() end
        humanoid.PlatformStand = false
    end
end

-- ایجاد دکمه‌های کنترل ارتفاع برای موبایل
local function createMobileControls(visible)
    if CoreGui:FindFirstChild("FlyControls") then CoreGui.FlyControls:Destroy() end
    if not visible then return end

    local sg = Instance.new("ScreenGui", CoreGui)
    sg.Name = "FlyControls"
    
    local upFrame = Instance.new("TextButton", sg)
    upFrame.Size = UDim2.new(0, 60, 0, 60)
    upFrame.Position = UDim2.new(0.8, 0, 0.5, 0)
    upFrame.Text = "UP"
    upFrame.BackgroundColor3 = Color3.fromRGB(95, 1, 136)
    
    local downFrame = Instance.new("TextButton", sg)
    downFrame.Size = UDim2.new(0, 60, 0, 60)
    downFrame.Position = UDim2.new(0.8, 0, 0.65, 0)
    downFrame.Text = "DOWN"
    downFrame.BackgroundColor3 = Color3.fromRGB(95, 1, 136)

    upFrame.MouseButton1Down:Connect(function() FlySettings.up = true end)
    upFrame.MouseButton1Up:Connect(function() FlySettings.up = false end)
    downFrame.MouseButton1Down:Connect(function() FlySettings.down = true end)
    downFrame.MouseButton1Up:Connect(function() FlySettings.down = false end)
end

-- تاگل پرواز طبق فرمت درخواستی
Practical:Toggle({
    Title = "فعال‌سازی پرواز (Mobile Fix)",
    Callback = function(state)
        FlySettings.flying = state
        createMobileControls(state) -- نمایش دکمه‌های بالا/پایین در موبایل
        
        if state then
            FlyConnection = RunService.RenderStepped:Connect(handleFly)
        else
            if FlyConnection then FlyConnection:Disconnect() end
            handleFly()
        end
    end
})

Practical:Slider({
    Title = "سرعت پرواز",
    Min = 16,
    Max = 300,
    Value = 50,
    Callback = function(value)
        FlySettings.speed = value
    end
})
